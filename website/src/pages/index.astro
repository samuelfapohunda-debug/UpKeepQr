---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import Hero from '../components/widgets/Hero.astro';
import Features from '../components/widgets/Features.astro';
import CallToAction from '../components/widgets/CallToAction.astro';
import Testimonials from '../components/widgets/Testimonials.astro';

// Get environment variable for Stripe link
const stripeOrderLink = import.meta.env.PUBLIC_STRIPE_LINK_1 || 'https://buy.stripe.com/test_8wMcOcbNy0kN8Ks5kk';
---

<Layout 
  title="UpkeepQR - Simple scans. Smart reminders."
  description="A fridge magnet that remembers home maintenance for you. Scan once, answer a few questions, and we'll nudge you when it's time."
>
  <Header showToggleTheme={true} />
  
  <!-- Hero Section -->
  <Hero
    title="Simple scans.<br><span class='text-accent-400'>Smart reminders.</span>"
    subtitle="A fridge magnet that remembers home maintenance for you. Scan once, answer a few questions, and we'll nudge you when it's time."
    actions={[
      {
        variant: 'primary',
        text: 'Order Magnets - $12.99',
        href: stripeOrderLink,
        target: '_blank'
      },
      {
        variant: 'outline',
        text: 'Watch Demo',
        href: '#demo'
      }
    ]}
    class="bg-primary-900"
  />

  <!-- How It Works Section -->
  <Features
    title="How it works"
    subtitle="Four simple steps to never forget home maintenance again"
    items={[
      {
        title: 'Scan the QR on your fridge',
        description: 'Quick scan with your phone camera',
        icon: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"></path>
        </svg>`
      },
      {
        title: 'Answer a 60-second setup',
        description: 'Tell us about your home details',
        icon: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
        </svg>`
      },
      {
        title: 'Get email/calendar reminders',
        description: 'Optional SMS notifications too',
        icon: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
        </svg>`
      },
      {
        title: 'One-tap "Book a Pro"',
        description: 'When you\'d rather not DIY',
        icon: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path>
        </svg>`
      }
    ]}
    columns={4}
    class="bg-light-gray"
  />

  <!-- Features Grid Section -->
  <Features
    title="Why homeowners love UpkeepQR"
    subtitle="Everything you need to maintain your home, simplified"
    items={[
      {
        title: 'Automated Reminders',
        description: 'Never forget an AC filter or smoke alarm check.',
        icon: '📅'
      },
      {
        title: 'Book a Pro',
        description: 'Tap once to connect with trusted local pros.',
        icon: '🛠️'
      },
      {
        title: 'Property Listings',
        description: 'List and showcase your property with ease.',
        icon: '🏠'
      },
      {
        title: 'Secure & Simple',
        description: 'Your info is private, and reminders just work.',
        icon: '🔒'
      }
    ]}
    columns={4}
    class="bg-white"
  />

  <!-- Demo Section -->
  <section id="demo" class="py-20 bg-light-gray">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-4xl font-poppins font-bold text-primary-900 mb-8">
        See it in action
      </h2>
      <div class="bg-slate-200 dark:bg-slate-700 rounded-lg p-12 mb-8">
        <p class="text-slate-600 dark:text-slate-300 text-lg">
          [Demo video placeholder - 2-minute walkthrough]
        </p>
      </div>
      <a 
        href="/order" 
        class="btn btn-primary text-lg shadow-md hover:shadow-lg"
        onclick="typeof gtag !== 'undefined' && gtag('event', 'cta_click', { 'cta_location': 'demo', 'cta_text': 'Get Started Now' });"
        data-testid="button-demo-cta"
      >
        Get Started Now
      </a>
    </div>
  </section>

  <!-- Testimonials Section -->
  <Testimonials
    title="What homeowners are saying"
    testimonials={[
      {
        name: 'Sarah M.',
        location: 'Atlanta, GA',
        content: 'Finally, I don\'t have to remember when to change my AC filter. The reminders are perfectly timed!'
      },
      {
        name: 'Mike D.',
        location: 'Nashville, TN',
        content: 'The pro booking feature saved me hours of research. One tap and I had a reliable contractor at my door.'
      },
      {
        name: 'Jennifer L.',
        location: 'Charlotte, NC',
        content: 'Such a simple concept, but it\'s made home ownership so much less stressful. Highly recommend!'
      }
    ]}
  />

  <!-- Final CTA Section -->
  <CallToAction
    title="Ready to never forget home maintenance again?"
    subtitle="Join thousands of homeowners who trust UpkeepQR to keep their homes in perfect condition."
    actions={[
      {
        variant: 'primary',
        text: 'Order Your Magnet Today',
        href: stripeOrderLink,
        target: '_blank'
      },
      {
        variant: 'outline',
        text: 'Learn More',
        href: '/faq'
      }
    ]}
  />

  <Footer />
</Layout>

<script>
  // Add Google Analytics event tracking
  document.addEventListener('DOMContentLoaded', function() {
    // Track CTA clicks if gtag is available
    const buttons = document.querySelectorAll('[data-testid^="button-"]');
    buttons.forEach(button => {
      button.addEventListener('click', function() {
        if (typeof gtag !== 'undefined') {
          const testId = this.getAttribute('data-testid');
          const text = this.textContent?.trim() || 'Unknown';
          gtag('event', 'cta_click', {
            'cta_location': 'button',
            'cta_text': text,
            'cta_testid': testId
          });
        }
      });
    });
  });
</script>