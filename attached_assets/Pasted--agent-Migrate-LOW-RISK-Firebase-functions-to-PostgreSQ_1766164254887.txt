@agent Migrate LOW RISK Firebase functions to PostgreSQL in server/storage.ts - Phase 2B Batch 1

OBJECTIVE:
Migrate 11 low-risk Firebase functions to use new PostgreSQL tables (agents, schedules, task_completions, reminder_queue, leads).

CONTEXT:
- File: server/storage.ts
- Phase 2A complete: All tables created in database
- Starting with lowest risk functions first

FUNCTIONS TO MIGRATE:

## 1. AGENTS (3 functions - around lines 196-223)

**getAgent()**
```typescript
// REPLACE Firebase:
async getAgent(id: string): Promise<Agent | undefined> {
  const doc = await adminDb.collection(COLLECTIONS.AGENTS).doc(id).get();
  return this.convertFirestoreData<Agent>(doc);
}

// WITH PostgreSQL:
async getAgent(id: string): Promise<Agent | undefined> {
  return await db.query.agentsTable.findFirst({
    where: eq(agentsTable.id, id)
  });
}
```

**getAgentByEmail()**
```typescript
// REPLACE Firebase:
async getAgentByEmail(email: string): Promise<Agent | undefined> {
  const query = await adminDb.collection(COLLECTIONS.AGENTS)
    .where('email', '==', email)
    .limit(1)
    .get();
  
  if (query.empty) return undefined;
  return this.convertFirestoreData<Agent>(query.docs[0]);
}

// WITH PostgreSQL:
async getAgentByEmail(email: string): Promise<Agent | undefined> {
  return await db.query.agentsTable.findFirst({
    where: eq(agentsTable.email, email)
  });
}
```

**createAgent()**
```typescript
// REPLACE Firebase:
async createAgent(agent: Partial<Agent>): Promise<Agent> {
  const id = agent.id || uuidv4();
  const newAgent: Agent = {
    ...agent,
    id,
    createdAt: new Date(),
    updatedAt: new Date()
  } as Agent;
  
  await adminDb.collection(COLLECTIONS.AGENTS).doc(id).set(newAgent);
  return newAgent;
}

// WITH PostgreSQL:
async createAgent(agent: Partial<Agent>): Promise<Agent> {
  const [result] = await db.insert(agentsTable)
    .values({
      ...agent,
      createdAt: new Date(),
      updatedAt: new Date()
    })
    .returning();
  return result;
}
```

## 2. SCHEDULES (2 functions - around lines 587-608)

**createSchedule()**
```typescript
// REPLACE Firebase:
async createSchedule(data: Record<string, unknown>): Promise<unknown> {
  const scheduleId = uuidv4();
  const schedule = {
    id: scheduleId,
    ...data,
    createdAt: new Date()
  };
  
  await adminDb.collection('schedules').doc(scheduleId).set(schedule);
  return schedule;
}

// WITH PostgreSQL:
async createSchedule(data: InsertSchedule): Promise<Schedule> {
  const [result] = await db.insert(schedulesTable)
    .values({
      ...data,
      createdAt: new Date(),
      updatedAt: new Date()
    })
    .returning();
  return result;
}
```

**getScheduleByHouseholdAndTask()**
```typescript
// REPLACE Firebase:
async getScheduleByHouseholdAndTask(householdId: string, taskName: string): Promise<unknown | undefined> {
  const query = await adminDb.collection('schedules')
    .where('householdId', '==', householdId)
    .where('taskName', '==', taskName)
    .limit(1)
    .get();
  
  if (query.empty) return undefined;
  return { id: query.docs[0].id, ...query.docs[0].data() };
}

// WITH PostgreSQL:
async getScheduleByHouseholdAndTask(householdId: string, taskName: string): Promise<Schedule | undefined> {
  return await db.query.schedulesTable.findFirst({
    where: and(
      eq(schedulesTable.householdId, householdId),
      eq(schedulesTable.taskName, taskName)
    )
  });
}
```

## 3. TASK COMPLETIONS (1 function - around lines 611-620)

**createTaskCompletion()**
```typescript
// REPLACE Firebase:
async createTaskCompletion(data: Record<string, unknown>): Promise<unknown> {
  const completionId = uuidv4();
  const completion = {
    id: completionId,
    ...data,
    createdAt: new Date()
  };
  
  await adminDb.collection('taskCompletions').doc(completionId).set(completion);
  return completion;
}

// WITH PostgreSQL:
async createTaskCompletion(data: InsertTaskCompletion): Promise<TaskCompletion> {
  const [result] = await db.insert(taskCompletionsTable)
    .values({
      ...data,
      createdAt: new Date()
    })
    .returning();
  return result;
}
```

## 4. REMINDER QUEUE (1 function - around lines 649-659)

**createReminderQueue()**
```typescript
// REPLACE Firebase:
async createReminderQueue(data: Record<string, unknown>): Promise<unknown> {
  const reminderId = uuidv4();
  const reminder = {
    id: reminderId,
    ...data,
    status: 'pending',
    createdAt: new Date()
  };
  
  await adminDb.collection('reminderQueue').doc(reminderId).set(reminder);
  return reminder;
}

// WITH PostgreSQL:
async createReminderQueue(data: InsertReminderQueue): Promise<ReminderQueue> {
  const [result] = await db.insert(reminderQueueTable)
    .values({
      ...data,
      status: 'pending',
      createdAt: new Date(),
      updatedAt: new Date()
    })
    .returning();
  return result;
}
```

## 5. ADD MISSING IMPORTS

At the top of server/storage.ts, ensure these imports exist:
```typescript
import { 
  agentsTable, 
  schedulesTable, 
  taskCompletionsTable, 
  reminderQueueTable,
  type Agent,
  type InsertAgent,
  type Schedule,
  type InsertSchedule,
  type TaskCompletion,
  type InsertTaskCompletion,
  type ReminderQueue,
  type InsertReminderQueue
} from "@shared/schema";
import { and } from "drizzle-orm";
```

VERIFICATION:
```bash
npm run build
grep -c "adminDb.*AGENTS\|adminDb.*schedules\|adminDb.*taskCompletions\|adminDb.*reminderQueue" server/storage.ts
# Should return 0 after migration
```

START NOW - Migrate all 11 functions in this batch!