```
@agent Critical 500 error on household creation - investigate and fix

PROBLEM:
POST to /api/setup/activate returns 500 (Internal Server Error) when trying to create a household. Error message: "Failed to complete setup. Please try again."

CONTEXT:
We just completed a Firebase to PostgreSQL migration where 28 functions were migrated. After migration, household creation broke with a 500 error.

STEPS ALREADY TAKEN:
1. ✅ Fixed missing .js extension in setup.ts import (was: "../../storage", now: "../../storage.js")
2. ✅ Rebuilt and deployed to production
3. ❌ Error still persists

CONSOLE SHOWS:
- POST https://upkeepqr-backend.onrender.com/api/setup/activate → 500 (Internal Server Error)
- "Admin mode: skipping customer data pre-fill"

INVESTIGATION NEEDED:

1. **Check Render logs** for the actual 500 error stack trace
   - What's the exact error message?
   - Which line is throwing?

2. **Verify setup.ts route** (server/src/routes/setup.ts)
   - Line 4: Should be `import { storage } from "../../storage.js";`
   - Check the /activate endpoint around line 20-150
   - Look for any calls to methods that no longer exist after migration

3. **Check for missing PostgreSQL tables or columns**
   - Does households table have all required fields?
   - Are there any Firebase-specific fields being referenced?

4. **Common issues to check:**
   - Calling a method that was renamed during migration
   - Missing table columns after schema changes
   - Wrong transaction syntax
   - Type mismatches between old Firebase types and new PostgreSQL types

5. **Check these specific things in setup.ts:**
   ```bash
   # Look for any remaining Firebase method calls
   grep -n "adminDb\|firestore\|firebase" server/src/routes/setup.ts
   
   # Check what storage methods are called
   grep -n "storage\." server/src/routes/setup.ts
   
   # See the actual error in build
   npm run build 2>&1 | grep -i error
   ```

FILES TO EXAMINE:
- server/src/routes/setup.ts (the failing endpoint)
- server/storage.ts (verify createHousehold exists and signature is correct)
- shared/schema.ts (verify householdsTable has all fields)

WHAT TO FIX:
Identify the root cause of the 500 error and fix it. The error is happening during household creation in the /activate endpoint.

VERIFICATION:
After fix:
1. Build should succeed
2. Creating a household should work without 500 error
3. Household should appear in database and dashboard

START INVESTIGATION NOW - This is blocking core functionality
```