# TASK: Connect Pricing Page Buttons to Stripe Checkout

## OBJECTIVE
Wire up the "Get Started" buttons on the pricing page to call the subscription checkout endpoint and redirect users to Stripe.

## CURRENT ISSUE
Buttons show error: "Checkout Unavailable - Subscription checkout is being set up"

## FILE TO MODIFY
`client/src/pages/Pricing.tsx` (or wherever the pricing cards are)

## IMPLEMENTATION

### Step 1: Add State and Checkout Handler

At the top of the component, add:
```typescript
import { useState } from 'react';

const [isLoading, setIsLoading] = useState<string | null>(null);

const handleCheckout = async (priceId: string, planName: string) => {
  setIsLoading(planName);
  
  try {
    const response = await fetch('/api/checkout/create-subscription-checkout', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        priceId: priceId,
        plan: planName,
      }),
    });

    const data = await response.json();

    if (data.url) {
      window.location.href = data.url;
    } else {
      alert(`Error: ${data.error || 'Failed to start checkout'}`);
      setIsLoading(null);
    }
  } catch (error) {
    console.error('Checkout error:', error);
    alert('An error occurred. Please try again.');
    setIsLoading(null);
  }
};
```

### Step 2: Update All "Get Started" Buttons

Replace each button's onClick handler:

**Homeowner Basic:**
```typescript
onClick={() => handleCheckout('price_1SmkS3RYhHBHe0FJEDorOdpo', 'Homeowner Basic')}
disabled={isLoading !== null}
```

**Homeowner Plus:**
```typescript
onClick={() => handleCheckout('HOMEOWNER_PLUS_PRICE_ID', 'Homeowner Plus')}
disabled={isLoading !== null}
```

**Realtor:**
```typescript
onClick={() => handleCheckout('REALTOR_PRICE_ID', 'Realtor / Agent')}
disabled={isLoading !== null}
```

**Property Manager:**
```typescript
onClick={() => handleCheckout('PROPERTY_MANAGER_PRICE_ID', 'Property Manager')}
disabled={isLoading !== null}
```

### Step 3: Update Button Text to Show Loading

Change button text to:
```typescript
{isLoading === 'Homeowner Basic' ? 'Loading...' : 'Get Started'}
```

### Step 4: Remove Error Toast/Alert

Find and remove any code showing "Checkout Unavailable" error.

## IMPORTANT
- DO NOT modify backend code
- DO NOT change Stripe configuration
- ONLY wire up frontend buttons to existing endpoint
- Use the exact price IDs from Replit Secrets

## TEST
After implementation, click "Get Started" button and verify:
- Button shows "Loading..."
- Browser redirects to Stripe checkout
- No errors appear

## COMMIT
After successful implementation:
```
git commit -m "feat: Wire up pricing buttons to Stripe checkout endpoint"
```
```

---

## üìã WHAT TO DO NEXT

### Option 1: Give Instructions to Replit Agent NOW

**While Render is deploying, have Replit Agent implement the checkout wiring.**

**Paste the instruction block above to Replit Agent.**

---

### Option 2: Wait for Render Deployment First

**Test what's currently deployed, then implement checkout wiring.**

**In 4 minutes, visit:**
```
https://upkeepqr-backend.onrender.com/pricing
```

**Check:**
- Does pricing page load?
- Do buttons still show "Checkout Unavailable" error?
- Any console errors?

---

## üéØ RECOMMENDED: Do Both Simultaneously

**Right now:**
1. ‚úÖ Render is deploying (automatic, just wait)
2. üîÑ Give Replit Agent the instructions (active task)
3. ‚è≥ Agent implements while Render deploys
4. üì¶ Commit Agent's changes
5. üöÄ Push again to deploy checkout integration

**This is the most efficient workflow!**

---

## ‚è∞ TIMELINE
```
[Now]        Code pushed to GitHub ‚úÖ
[+30s]       Render deployment started
[+1-2m]      Give Replit Agent instructions
[+2-3m]      Agent implements checkout wiring
[+4m]        Render deployment completes
[+5m]        Commit Agent's changes
[+6m]        Push checkout integration
[+10m]       Full system deployed and working! üéâ